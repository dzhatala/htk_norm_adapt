var Forums={};Forums.Constants={ExpandCollapseImage:'<img src="'+ForumsRes.url_transGif+'" class="expcol"/>',ExpandCollapseLink:'<a class="expcol" href="javascript:void(0);"/>',ExpandCollapseImageRef:"img.expcol",ExpandCollapseLinkRef:"a.expcol",ThreadPageDwellTimeInSecs:30},Forums.Rte={IsOpen:!1,IsReady:!1,canShow:function(n){return Forums.Rte.IsOpen===!1?!0:(n===!0&&alert(ForumsRes.rte_alreadyOpen),!1)},isRtl:function(){return $("div#BodyBackground").hasClass("rtl")},show:function(){return Forums.Rte.IsOpen===!0?!1:(setTimeout(function(){Forums.Rte.IsReady=!0},ForumsRes.rte_readyDelay),Forums.Rte.IsOpen=!0,!0)},hide:function(){Forums.Rte.IsOpen=!1,Forums.Rte.IsReady=!1},isBodyLengthValid:function(n){var t=0;return n!==null&&Forums.Rte.trimString(n)!==""&&(t=n.length),t<4||t>6e4?(alert(ForumsRes.rte_msgBodyLength),!1):!0},trimString:function(n){var t=n.replace(/(\&nbsp\;)+/g," ");return t.replace(/^\s+|\s+$/g,"")},isUnTrustedUserPostValid:function(n){var i=Forums.Rte.getImageCount(n),t=Forums.Rte.getLinkCount(n);return i==0&&t==0},getImageCount:function(n){var i=new RegExp("<img+.*?((/>)|(</img>))","ig"),t=n===null||Forums.Rte.trimString(n)===""?0:n.match(i);return t==null&&(t=0),t},getLinkCount:function(n){var i=new RegExp("<a+.*?((/>)|)","ig"),t=n===null||Forums.Rte.trimString(n)===""?0:n.match(i);return t==null&&(t=0),t},isBodyImageCountValid:function(n){var u=0,f=new RegExp("Forums/getfile/?[0-9]*","ig"),t=Forums.Rte.getImageCount(n),i,r;if(t!==null&&t.length>0)for(i=0;i<t.length;i++)r=t[i].match(f),r!==null&&r.length>0&&u++;return u>ForumsRes.rte_MaxAttachments?!1:!0},UnPrettifyCodeBlocks:function(n){$("pre.prettyprint",n).each(function(){$(this).removeClass("prettyprinted"),$("span",$(this)).each(function(){$(this).replaceWith(function(){return $(this).contents()}),$(this).html($("<div/>").text($(this).html()).html())})})}},Forums.Filters={decorateFilters:function(){var n=$(this);$("h6",this).prepend(Forums.Constants.ExpandCollapseLink),$("h6",this).click(function(){$(n).children("div.content").children("div.advanced").slideToggle("fast"),$(n).toggleClass("expanded")}),$("h6",this).mouseover(function(){$(n).addClass("hover")}),$("h6",this).mouseout(function(){$(n).removeClass("hover")}),$("div.advanced li a",this).hasClass("selected")&&$("h6",this).click()}},Forums.Message={autoSubscribeValue:function(n){var t=!1,i,r;try{t=pageData.autoSubscribe,t||(i=$(n).parents("li.thread"),i!=null&&i.length>0?$("h3 > img",i).hasClass("alert")&&(t=!0):(r=$("ul.thread.menu > li > a[name='unsubscribe']"),r!=null&&r.length>0&&(t=!0)))}catch(u){}return t?"checked='checked'":""},edit:function(){var n=$(this).parents("li.message");$(this).click(function(){var e,r,u;if(!Forums.Rte.canShow(!0))return!1;var i=$(n).attr("id")+"body",f="<textarea class='rte' id='"+i+"'></textarea>",t=$("div.body",n);return Forums.Rte.UnPrettifyCodeBlocks(t),e=$("#"+$(n).attr("id")+"_attachments").attr("value"),$("div.quote",t).wrap("<blockquote/>"),r=$(t).html()+"<br/>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id"),body:r},success:function(n){f=n}}),$(t).hide(),$("div.helpful, ul.history, div.abusive, div.menu, div.votingouterbox, div.voting,span.votinglabel",n).hide(),u="<div class='editor"+(Forums.Rte.isRtl()?" t-rtl":"")+"'><form>"+f+"<input type='hidden' name='attachmentIds' value='"+e+"'/></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>&nbsp;<label>"+ForumsRes.rte_reasonLabel+"</label><input type='text' name='reason'/></div><div class='ajaxError submitEditError'></div></div>",$(t).after(u),Forums.Rte.show(),$("button[name='submit']",n).click(Forums.Message.submitEdit(n,$(this).attr("url"))),$("button[name='cancel']",n).click(function(){Forums.Rte.hide(),$("#"+i).data("tEditor")!==undefined&&$("#"+i).data("tEditor").window.focus(),$("div.editor",n).remove(),$(t).show(),$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",n).show(),prettyPrint()}),$("button[name='submit']",n).get(0).scrollIntoView(!1),!1})},reply:function(){var n=$(this).parents("li.message");$(this).click(function(){var r,i,t;return Forums.Rte.canShow(!0)?(r=$(n).attr("id")+"body",i="<textarea class='rte' id='"+r+"'></textarea>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id")},success:function(n){i=n}}),i=i.replace("if (!$.browser.msie || ($.browser.msie && $.browser.version >= 9))","if (!$.browser.msie || ($.browser.msie && $.browser.version >= 9 && document.documentMode >= 9))"),t="<div class='editor"+(Forums.Rte.isRtl()?" t-rtl":"")+"'><form>"+i+"<input type='hidden' name='attachmentIds'/></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>",userEmailConfigured&&(t=t+"&nbsp;<input type='checkbox' name='subscribe' "+Forums.Message.autoSubscribeValue(n)+"/><label>"+ForumsRes.rte_subscribeText+"</label>"),t+="<div><div class='submitReplyError ajaxerror'></div></div>",t=t+"</div></div>",$(n).append(t),Forums.Rte.show(),$("button[name='submit']",n).click(Forums.Message.submitReply(n,$(this).attr("url"))),$("button[name='cancel']",n).click(function(){Forums.Rte.hide(),$("#"+r).data("tEditor")!==undefined&&$("#"+r).data("tEditor").window.focus(),$("div.editor",n).remove()}),$("button[name='submit']",n).get(0).scrollIntoView(!1),!1):!1})},quote:function(){var n=$(this).parents("li.message");$(this).click(function(){var f,h,i;if(!Forums.Rte.canShow(!0))return!1;var e=$(n).attr("id")+"body",s="<textarea class='rte' id='"+e+"'></textarea>",u=$("div.body",n);u=u.clone(),Forums.Rte.UnPrettifyCodeBlocks(u);var t=$(u).html(),r="<blockquote>",o="</blockquote>";return t.substring(0,r.length)===r&&(t=t.replace(r,"<p>"),f=t.lastIndexOf(o),t=t.substring(0,f)+"</p>"+t.substring(f+o.length)),t=r+t+o+"<br/>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id"),body:t},success:function(n){s=n}}),h=$("div.helpful",n),i="<div class='editor"+(Forums.Rte.isRtl()?" t-rtl":"")+"'><form>"+s+"<input type='hidden' name='attachmentIds' value='' /></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>",userEmailConfigured&&(i=i+"&nbsp;<input type='checkbox' name='subscribe' "+Forums.Message.autoSubscribeValue(n)+"/><label>"+ForumsRes.rte_subscribeText+"</label>"),i=i+"</div></div>",$(n).append(i),Forums.Rte.show(),$("button[name='submit']",n).click(Forums.Message.submitReply(n,$(this).attr("url"))),$("button[name='cancel']",n).click(function(){Forums.Rte.hide(),$("#"+e).data("tEditor")!==undefined&&$("#"+e).data("tEditor").window.focus(),$("div.editor",n).remove()}),$("button[name='submit']",n).get(0).scrollIntoView(!1),!1})},submitEdit:function(n,t){return function(){var f=$("div.editor",n),s=$(n).attr("id")+"body",i=$("#"+s),u=i[0].nodeName.toLowerCase(),r,e,o;if(u==="table"&&i.data("tEditor")===undefined)return!1;if($("div.editor button",n).attr("disabled","disabled"),r=u==="table"?i.data("tEditor").value():i.val(),$("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(r))return alert(ForumsRes.MessageBodyUnTrustedUser),$("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyLengthValid(r))return $("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;$(f).append('<div class="submitting"></div>'),$(f).addClass("submitting"),e=$("div.editor > div.commands > input[name='reason']",n).val(),o=$("div.editor input[name='attachmentIds']",n).attr("value"),$.ajax({type:"POST",url:t,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),body:r,reason:e,attachmentIds:o},success:function(t){typeof t=="object"&&t.StatusCode=="500"?Forums.Common.ShowPrompt(t.Message,t.Confirm,t.Redirect):(Forums.Rte.hide(),u==="table"&&i.data("tEditor").window.focus(),$("div.editor",n).remove(),$(n).after(t).next().hide().fadeIn("fast").each(Forums.Message.decorateMessage),prettyPrint(),$(n).remove())},error:function(t){$("div.submitting",f).remove(),$("div.editor button",n).removeAttr("disabled"),alert(t.responseText)}})}},submitReply:function(n,t){return function(){var f=$("div.editor",n),s=$(n).attr("id")+"body",i=$("#"+s),u=i[0].nodeName.toLowerCase(),r,e,o;if(u==="table"&&i.data("tEditor")===undefined)return!1;if($("div.editor button",n).attr("disabled","disabled"),r=u==="table"?i.data("tEditor").value():i.val(),$("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(r))return alert(ForumsRes.MessageBodyUnTrustedUser),$("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyLengthValid(r))return $("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;$(f).append('<div class="submitting"></div>'),$(f).addClass("submitting"),e=$("div.editor input[name='attachmentIds']",n).attr("value"),o=$("div.editor > div.commands > input[name='subscribe']",n).is(":checked"),$.ajax({type:"POST",url:t,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),body:r,attachmentIds:e,subscribe:o},success:function(t){typeof t=="object"&&t.StatusCode=="500"?Forums.Common.ShowPrompt(t.Message,t.Confirm,t.Redirect):(Forums.Rte.hide(),u==="table"&&i.data("tEditor").window.focus(),$("div.editor",n).remove(),$(n).after(t).next().hide().fadeIn("fast").addClass("new").each(Forums.Message.decorateMessage),prettyPrint())},error:function(t){$("div.submitting",f).remove(),$("div.editor button",n).removeAttr("disabled"),$("div.submitReplyError").html(t.responseText).show()}})}},messageAction:function(n,t){return function(){var i=$(n).parents("li.message"),r=$(i).attr("id");return $(i).append('<div class="submitting"></div>'),$(i).addClass("submitting"),t.__RequestVerificationToken=Forums.Message.AddAntiForgeryToken(),url=$(n).attr("url")?$(n).attr("url"):$(n).attr("href"),$.ajax({type:"POST",url:url,data:t,success:function(n){if($(t).find(".messageContentContainer").length==0)$("li.message[id='"+r+"']").replaceWith(n),$("li.message[id='"+r+"']").each(Forums.Message.decorateMessage);else{var t=$("li.message[id='"+r+"']"),f=$(n).find(".messageContentContainer").html(),u=$(n).closest("li.message[id='"+r+"']").attr("class");$(t).find(".messageContentContainer").html(f),$(t).each(Forums.Message.decorateMessage),u&&$(t).attr("class",u),$(i).removeClass("submitting")}},error:function(n){$("div.submitting",i).remove(),alert(n.responseText)}}),!1}},promptAction:function(n,t,i){return function(){return Forums.HTML.createPopup(t),$("#okButton").click(function(){i.reason=$("#reason").attr("value"),Forums.Message.messageAction(n,i)();var t=$(n).parents("li.message");$(".menu.message",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#reason").keypress(function(n){n.which==13&&$("#okButton").click()}),$("#cancelButton").click(function(){var t=$(n).parents("li.message");$(".menu.message",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#closeButton").click(function(){var t=$(n).parents("li.message");$(".menu.message",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),!1}},answer:function(){$(this).click(Forums.Message.messageAction($(this),{isAnswer:!0}))},unanswer:function(){$(this).click(Forums.Message.messageAction($(this),{isAnswer:!1}))},proposeAnswer:function(){$(this).click(Forums.Message.messageAction($(this),{isProposed:!0}))},unproposeAnswer:function(){$(this).click(Forums.Message.messageAction($(this),{isProposed:!1}))},clearAbuse:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_clearAbuseReason,{isAbuse:!1}))},reportAbuse:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_reportAbuseReason,{isAbuse:!0}))},deleteMessage:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_deleteReason,{isDeleted:!0}))},undeleteMessage:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_undeleteReason,{isDeleted:!1}))},gotoUrl:function(){return $(this).click(function(){window.location=$(this).attr("url")}),!1},voteHelpful:function(){var n=$(this);$(this).click(function(){$(n).fadeOut("fast");var t=$(n).parents("li.message");return $("div.helpful > span > img",t).addClass("submitting"),$.ajax({type:"POST",url:$(n).attr("href"),data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),isHelpful:!0},dataType:"json",success:function(n){$("div.helpful > span > span",t).text(n.Votes),$("div.helpful > span > img",t).removeClass("submitting")},error:function(n){$("div.helpful > span > img",t).removeClass("submitting"),alert(n.responseText)}}),!1})},voteUp:function(){$(this).click(Forums.Message.messageAction($(this),{isHelpful:!0}))},voteDown:function(){$(this).click(Forums.Message.messageAction($(this),{isHelpful:!1}))},decorateMessage:function(){var t,n,i;if(typeof pageData=="undefined"||pageData==null||pageData.validUser==!1){t=$("div.menu.message",this),$("a[name='reply']",t).each(Forums.Message.gotoUrl),$("a[name='quote']",t).each(Forums.Message.gotoUrl),$("div.helpful a.vote",this).each(Forums.Message.gotoUrl);return}$("a[name='reportAbuse']",this).each(Forums.Message.reportAbuse),$("a[name='clearAbuse']",this).each(Forums.Message.clearAbuse),$("div.helpful a.vote",this).each(Forums.Message.voteHelpful),$("a[name='voteup']",this).each(Forums.Message.voteUp),$("a[name='votedown']",this).each(Forums.Message.voteDown),n=$("div.menu.message",this),$("a[name='setAnswer']",n).each(Forums.Message.answer),$("a[name='unsetAnswer']",n).each(Forums.Message.unanswer),$("a[name='proposeAnswer']",n).each(Forums.Message.proposeAnswer),$("a[name='unproposeAnswer']",n).each(Forums.Message.unproposeAnswer),$("a[name='reply']",n).each(Forums.Message.reply),$("a[name='quote']",n).each(Forums.Message.quote),$("a[name='edit']",n).each(Forums.Message.edit),$("a[name='delete']",n).each(Forums.Message.deleteMessage),$("a[name='undelete']",n).each(Forums.Message.undeleteMessage),$("a[name='split']",n).each(Forums.Message.gotoUrl),$("a.popup",this).popup(),i=Forums.Homepage.getChildIdList("#ReportAbusePopup","li"),$("#ReportAbuse").attr("aria-owns",i)},AddAntiForgeryToken:function(){return $("#__AjaxAntiForgeryForm input[name='__RequestVerificationToken']").attr("value")}},Forums.HTML={createPopup:function(n){var r,f,t,u,e,i;$("#boxes").length>0&&($("#mask").remove(),$("#dialog").remove(),$("#boxes").remove()),r="",n===ForumsRes.prompt_deleteReason&&(r="<div style='padding: 0px 5px 10px 5px;margin-top: 15px;'><label for='cbox'>Report spam or advertising</label><input type='checkbox' id='cbox' value='checkbox'></div>"),f="<div id='boxes'><div id='dialog' class='window'><div class='poupTitle'><label id='resonLabel'>"+n+"</label><img title='Close' id='closeButton' class='icon delete' src=\""+ForumsRes.url_transGif+"\" complete='complete' ></img></div><div style='padding:0px 5px 10px 5px;'><span class='textSpan'><input type='text' id='reason' name='reason' value='' /></span><span class='buttonSpan'><button id='okButton' name='ok' >"+ForumsRes.rte_OKText+"</button><button id='cancelButton' name='cancel' > "+ForumsRes.rte_cancelText+"</button></span></div>"+r+"</div><div id='mask'></div></div>",$("body").append(f),t="#dialog",u="#mask",$("#reason").select(),$("#reason").focus(),e=($(window).height()-$(t).height())/2+$(window).scrollTop(),i=($(window).width()-$(t).width())/2+$(window).scrollLeft(),$(t).css({top:e,left:i>0?i:0,display:"block"}),this.addAnimation(t),$(u).css({top:0,left:0,width:$(document).width(),height:$(document).height()}),$(u).fadeTo("fast",.5)},addAnimation:function(n){$(window).resize(function(){var i=($(window).height()-$(n).height())/2+$(window).scrollTop(),t=($(window).width()-$(n).width())/2+$(window).scrollLeft();$(n).css({top:i,left:t>0?t:0})}),$(window).scroll(function(){var i=($(window).height()-$(n).height())/2+$(window).scrollTop(),t=($(window).width()-$(n).width())/2+$(window).scrollLeft();$(n).css({top:i,left:t>0?t:0})})}},Forums.Thread={threadAction:function(n,t){return function(){return $("img.icon",n).addClass("submitting"),t.__RequestVerificationToken=Forums.Message.AddAntiForgeryToken(),url=$(n).attr("url")?$(n).attr("url"):$(n).attr("href"),$.ajax({type:"POST",url:url,data:t,dataType:"json",success:function(n){window.location=n.url},error:function(t){$("img.icon",n).removeClass("submitting"),alert(t.responseText)}}),!1}},promptAction:function(n,t,i){return function(){return Forums.HTML.createPopup(t),$("#okButton").click(function(){var r,t;if(i.stickyDate=="")if(r=$("#reason").attr("value"),Forums.Thread.isStickyDateValid(r))i.stickyDate=$("#reason").attr("value");else return $("#reason").val(""),alert(ForumsRes.StickyDateInValid),!1;else i.reason=$("#reason").attr("value");$("#cbox").attr("checked")==="checked"&&(i.reason+="[SpamOrAdvertising]"),Forums.Thread.threadAction(n,i)(),t=$(n).parents("li.message.root"),$(".menu.thread",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#reason").keypress(function(n){n.which==13&&$("#okButton").click()}),$("#cancelButton").click(function(){var t=$(n).parents("li.message.root");$(".menu.thread",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#closeButton").click(function(){var t=$(n).parents("li.message.root");$(".menu.thread",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),!1}},AddAntiForgeryToken:function(){return $("#__AjaxAntiForgeryForm input[name='__RequestVerificationToken']").attr("value")},editThread:function(){var n=$(this).parents("li.message");$(this).click(function(){var f,u,r;if(!Forums.Rte.canShow(!0))return!1;var i=$(n).attr("id")+"body",e="<textarea class='rte' id='"+i+"'></textarea>",o=$("#content h1 span[name='subject']").text(),t=$("div.body",n);return Forums.Rte.UnPrettifyCodeBlocks(t),f=$("#"+$(n).attr("id")+"_attachments").attr("value"),u=$(t).html()+"<br/>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id"),body:u},success:function(n){e=n}}),$(t).hide(),$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",n).hide(),r="<div class='editor"+(Forums.Rte.isRtl()?" t-rtl":"")+"'><label>"+ForumsRes.rte_subjectLabel+"</label> <input type='text' id='subject' size='60' /><form>"+e+"<input type='hidden' name='attachmentIds' value='"+f+"'/></form><div class='commands'><button id='submit'>"+ForumsRes.rte_submitText+"</button><button id='cancel'>"+ForumsRes.rte_cancelText+"</button>&nbsp;<label>"+ForumsRes.rte_reasonLabel+"</label><input type='text' id='reason'/></div><div><div class='submitEditError ajaxerror'></div></div></div>",$(t).after(r),$("#subject",n).val(o),Forums.Rte.show(),$("#submit",n).click(Forums.Thread.submitEdit(n,$(this).attr("url"))),$("#cancel",n).click(function(){Forums.Rte.hide(),$("#"+i).data("tEditor")!==undefined&&$("#"+i).data("tEditor").window.focus(),$("div.editor",n).remove(),$(t).show(),$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",n).show(),prettyPrint()}),$("#submit",n).get(0).scrollIntoView(!1),!1})},submitEdit:function(n,t){return function(){var e=$("div.editor"),f=$("div.editor",n),h=$(n).attr("id")+"body",i=$("#"+h),u=i[0].nodeName.toLowerCase(),r;if(u==="table"&&i.data("tEditor")===undefined)return!1;if(e.find("button").attr("disabled","disabled"),r=u==="table"?i.data("tEditor").value():i.val(),$("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(r))return alert(ForumsRes.MessageBodyUnTrustedUser),$("#submit",n).attr("disabled",!1),$("#cancel",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyLengthValid(r))return $("#submit",n).attr("disabled",!1),$("#cancel",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyImageCountValid(r))return alert(ForumsRes.rte_MaxAttachmentsErrMsg),$("#submit",n).attr("disabled",!1),$("#cancel",n).attr("disabled",!1),!1;$(f).append('<div class="submitting"></div>'),$(f).addClass("submitting");var c=e.find("#reason").val(),o=e.find("#subject").val(),s=$("div.editor input[name='attachmentIds']",n).attr("value");$.ajax({type:"POST",url:t,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),subject:o,body:r,reason:c,attachmentIds:s},dataType:"json",success:function(t){typeof t=="object"&&t.StatusCode&&t.StatusCode=="500"?Forums.Common.ShowPrompt(t.Message,t.Confirm,t.Redirect):(u==="table"&&i.data("tEditor").window.focus(),$("div.editor",n).remove(),window.location=t.url)},error:function(t){$("div.submitting",f).remove(),$("div.editor button",n).removeAttr("disabled"),$("div.submitEditError").html(t.responseText).show()}})}},clearSticky:function(){$(this).click(Forums.Thread.threadAction(this,{stickyDate:""}))},deleteThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_deleteReason,{isDeleted:!0}))},lock:function(){$(this).click(Forums.Thread.threadAction(this,{isLocked:!0}))},makeSticky:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_stickyUntil,{stickyDate:""}))},subscribe:function(){$(this).click(Forums.Thread.threadAction(this,{isSubscribed:!0}))},undeleteThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_undeleteReason,{isDeleted:!1}))},unlock:function(){$(this).click(Forums.Thread.threadAction(this,{isLocked:!1}))},unsubscribe:function(){$(this).click(Forums.Thread.threadAction(this,{isSubscribed:!1}))},join:function(){$(this).click(Forums.Thread.threadAction($(this),{isJoined:!0}))},unjoin:function(){$(this).click(Forums.Thread.threadAction($(this),{isJoined:!1}))},decorateThreadMenu:function(){$("a[name='delete']",this).each(Forums.Thread.deleteThread),$("a[name='undelete']",this).each(Forums.Thread.undeleteThread),$("a[name='editThread']",this).each(Forums.Thread.editThread),$("a[name='lock']",this).each(Forums.Thread.lock),$("a[name='unlock']",this).each(Forums.Thread.unlock),$("a[name='sticky']",this).each(Forums.Thread.makeSticky),$("a[name='clearSticky']",this).each(Forums.Thread.clearSticky),$("a[name='subscribe']",this).each(Forums.Thread.subscribe),$("a[name='unsubscribe']",this).each(Forums.Thread.unsubscribe),$("a[name='joinQuestion']").each(Forums.Thread.join),$("a[name='unJoinQuestion']").each(Forums.Thread.unjoin),$("a[name='move']").each(Forums.Message.gotoUrl),$("a[name='merge']").each(Forums.Message.gotoUrl),$("a[name='assign']").each(Forums.Message.gotoUrl),$("a[name='changeType']").each(Forums.Message.gotoUrl)},messagesLoaded:function(n){var t,r,u,i;$(n).removeClass("loading"),$(n).removeClass("hasUnread"),$(n).removeClass("new"),$(n).addClass("loaded"),$(n).addClass("viewed"),$("div.preview",n).append('<div class="links"></div>'),t=$("div.links",n),$(t).append('<a name="view"></a>'),r=$("a[name='view']",t),u=$("h3 a:eq(1)",n).attr("href"),$(r).text(ForumsRes.thread_viewThreadText).attr("href",u).attr("title",ForumsRes.thread_viewThreadText),$(t).append('<a name="close"></a>'),i=$("a[name='close']",t),$(i).text(ForumsRes.thread_closePreviewText).attr("href","javascript:void(0)").attr("title",ForumsRes.thread_closePreviewText),$(i).click(function(){$("h3",n).click()}),$("div.preview",n).slideToggle("fast"),$("li.message",n).each(Forums.Message.decorateMessage),prettyPrint()},decorateThread:function(){var n=$(this);$("h3 > a",this).before(Forums.Constants.ExpandCollapseLink),$(this).append('<div class="preview"></div>'),$("h3",this).click(function(t){if((t.target.nodeName.toLowerCase()!=="a"||t.target.className==="expcol")&&($(n).toggleClass("expanded"),!$(n).hasClass("loading"))){if($(n).hasClass("loaded")){$("div.editor button[name='cancel']",n).click(),$("div.preview",n).slideToggle("fast");return}$(n).addClass("loading");var i=$("h3:first > a:eq(1)",n).attr("href")+"/messages?time="+ +new Date;i=i.substring(7),i=i.substring(i.indexOf("/")),$("div.preview",n).load(i,null,function(){Forums.Thread.messagesLoaded(n),$("li.message",this).profileWidgitize()})}}),$("h3",this).mouseover(function(){$(n).addClass("hover")}),$("h3",this).mouseout(function(){$(n).removeClass("hover")})},isStickyDateValid:function(n){var t,f,r,u;if(n.length!=10||(t=n.split("-"),t.length!=3))return!1;for(f="^[0-9]+$",i=0;i<3;i++)if(!t[i].match(f))return!1;return(r=new Date(t[0],t[1]-1,t[2]),r.getFullYear()!=t[0]||r.getMonth()!=t[1]-1||r.getDate()!=t[2])?!1:(u=new Date,r<u?!1:!0)}},Forums.QuickLinks={wire:function(){$("#quickLinks").click(function(n){Forums.Common.SubmitMetricsToAI("Homepage.QuickAccessExpanded"),Forums.Homepage.toggleDropDown($(this),n)}),$("ul.popup li > a","#quickLinks").click(function(n){return Forums.Common.SubmitMetricsToAIAndRedirect("Homepage.QuickAccesLinkClicked",{linkId:$(this).attr("Id")},$(this).attr("href"),n.ctrlKey)}),$("#quickLinks").keypress(function(n){n.which==13&&$("#quickLinks").click()});var n=Forums.Homepage.getChildIdList("#quickAccessPopup","li");$("#quickLinks").attr("aria-owns",n)}},Forums.MyActivityWidget={wire:function(){$("#myThreadAllLink").live("click",function(n){return Forums.Common.SubmitMetricsToAIAndRedirect("MyActivity.MyThreadClicked",null,$(this).attr("href"),n.ctrlKey)}),$("#myThreadAnsweredLink").live("click",function(n){return Forums.Common.SubmitMetricsToAIAndRedirect("MyActivity.MyThreadAnsweredClicked",null,$(this).attr("href"),n.ctrlKey)}),$("#myThreadUnansweredLink").live("click",function(n){return Forums.Common.SubmitMetricsToAIAndRedirect("MyActivity.MyThreadUnansweredClicked",null,$(this).attr("href"),n.ctrlKey)}),$("#myThreadUnreadLink").live("click",function(n){return Forums.Common.SubmitMetricsToAIAndRedirect("MyActivity.MyThreadUnreadClicked",null,$(this).attr("href"),n.ctrlKey)})}},Forums.Homepage={Actions:{Category:0,CategoryAll:1,CategoryViewAll:2,Filter:5,Sort:6,Search:7,Clear:8,FilterWithAllLanguages:9},wireTopBar:function(n){Forums.Homepage.searchWatermark=n,Forums.Homepage.wireFilterBar(n),Forums.ThreadPage.wireSearchBar(n),Forums.QuickLinks.wire(),Forums.MyActivityWidget.wire()},wirePageElements:function(n){Forums.Homepage.wireThreadListView(),Forums.Homepage.wireCategoryList(),Forums.Homepage.wireTagsList(),Forums.ForumDetails.wireForumDetailLinks(),Forums.Homepage.wireAnnouncements(),Forums.Homepage.wireActivitySidebarSection(),Forums.ThreadPage.attachTooltipHandler(),Forums.Homepage.categoriesWatermark=n,$.addToRail(railItems),Forums.Homepage.loadAllCategories(),$(".btn.askQuestionLink").click(function(n){return Forums.Common.SubmitMetricsToAIAndRedirect("Homepage.AskAQuestionClicked",{linkhref:$(this).attr("href")},$(this).attr("href"),n.ctrlKey),!1})},rewirePageElements:function(){Forums.Toggler.setup(),Forums.Homepage.wirePageElements(Forums.Homepage.categoriesWatermark,Forums.Homepage.searchWatermark)},rewireSearchElements:function(){Forums.Toggler.wireToggleButton(),Forums.Homepage.wireFilterBar(Forums.Homepage.searchWatermark),Forums.Homepage.wireTagsList(Forums.Homepage.searchQuestionswatermark),Forums.ForumDetails.wireForumDetailLinks(),Forums.Homepage.replaceSearchUrl(),Forums.Homepage.replaceAnnouncements(),Forums.Homepage.wireAnnouncements(),Forums.Homepage.wireThreadListView(),Forums.Homepage.addSelectedClassToSelectedCategoryHeaders(),Forums.ThreadPage.attachTooltipHandler()},replaceAnnouncements:function(){$("#topBarImportantInfoContainer").html($("#searchAnnouncmentContainer").html())},replaceSearchUrl:function(){$("#homesearchform").attr("action",$("#hdnSearchUrl").val())},loadAllCategories:function(){var n=$("#allCategoryPopupContainer"),i=($(window).width()-n.width())/2,t;$(n).css("left",i),$("#allCategoryListContainer",$(n)).length==0?(t=$(n).data("url"),t=Forums.AppendQuestionOrAmpersandToUrl(t)+"time="+ +new Date,$.ajax({url:t}).done(function(t){var i,r;$("#allCategoryPopupContainer").html(t),Forums.Homepage.wireGetAllCategories(),i=$(window).height()*.8-160,$("#categoriesListing").children("ul").height(i<400?i:400),r=($(window).height()-n.height())/2,$(n).css("top",r),Forums.Homepage.setAllCategoriesSelectedItems()})):Forums.Homepage.setAllCategoriesSelectedItems()},wireGetAllCategories:function(){function i(){$("#searchbox","#allCategoriesSearchContainer").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.AllForumsPopupSearchBoxClicked")}),$("#allCategoriesSearchContainer").find("#searchbox").bind("input keyup",function(){Forums.Homepage.handleSearchBoxChanged(this,t)})}function r(t){$("#allCategoriesListChanged").val()=="true"?Forums.Homepage.redirectHomePage($("#allCategoryListContainer"),$("#homePageFilterBarContainer"),Forums.Homepage.searchWatermark,Forums.Homepage.Actions.CategoryViewAll):n(t)}function n(n){Forums.Homepage.hideDropDown(n),$("#viewallCategoriesContainer").find(".arrowdown").addClass("invisible").removeClass("visible"),n.stopPropagation()}function t(n){Forums.Rte.trimString(n)!==""?$("#allCategoryPopupContainer").find(".categoryArea").each(function(){var i=$(this).find(".forumFilter"),r=$(this).find(".categoryHeaderText:first").html(),u=r.toUpperCase().indexOf(n.toUpperCase())!==-1,t=$(this).find(".checkboxText:Contains('"+n+"')");u?($(i).find(".forumItem").show(),$(this).show()):($(t).each(function(){$(this).parents(".forumItem:first").show()}),$(this).find(".checkboxText:not(:Contains('"+n+"'))").each(function(){$(this).parents(".forumItem:first").hide()}),$(this).toggle(t.length>0)),t.length>0?Forums.Homepage.showForumList(i):Forums.Homepage.hideForumList(i)}):($("#allCategoryPopupContainer").find(".categoryArea").show(),$("#allCategoryPopupContainer").find(".forumFilter").each(function(){Forums.Homepage.hideForumList($(this))}),$("#allCategoryPopupContainer").find(".forumFilter:has(.chkForumSelector:checked)").each(function(){Forums.Homepage.showForumList($(this))}),$("#allCategoryPopupContainer").find(".forumItem").show())}Forums.Homepage.wireAllCategoriesBox(Forums.Homepage.categoriesWatermark),i(),$("#submitAllCategories").click(function(n){Forums.Common.SubmitMetricsToAI("Homepage.AllForumsPopupSubmitClicked"),r(n)}),$("#closeAllCategoryPopup").click(function(t){Forums.Common.SubmitMetricsToAI("Homepage.AllForumsPopupCloseLinkClicked"),n(t)}),$("#closeAllCategoryPopup").keydown(function(n){n.keyCode==13&&$("#viewallCategoriesContainer").trigger("click")}),Forums.Homepage.wireCategoryListElements($("#allCategoryPopupContainer")),Forums.Homepage.setAllCategoriesSelectedItems(),$("#allCategoryListContainer").find(".selectallcheckbox").change(function(){Forums.Homepage.selectAllForums($(this)),Forums.Homepage.updateSelectedForumsCount()}),$("#allCategoryListContainer").find('input[type="checkbox"]').change(function(){$("#allCategoriesListChanged").val(!0),Forums.Homepage.updateSelectedForumsCount()}),Forums.Homepage.updateSelectedForumsCount()},handleSearchBoxChanged:function(n,t){n=$(n),window.clearTimeout(n.data("refresh_timer"));var i="";return n.hasClass("watermark")||(i=n.val()),n.data("refresh_timer",setTimeout(function(){t(i)},500)),!1},setAllCategoriesSelectedItems:function(){Forums.Homepage.setCategoryScopingState("#allCategoryListContainer"),Forums.Homepage.updateSelectedForumsCount()},wireAskAQuestion:function(n){var r=$(".btn.askQuestionLink","#msdn-technet-en-home"),u="",t="",f=$(r).data("askurlbase"),i;n.length===1&&(t=n[0],u=$(".categoryHeader.selected:first").parents("li.categoryArea:first").data("categoryname")),i=f+"?category="+u+"&forum="+t,$(r).attr("href",i)},wireThreadListView:function(){$(".pager a","#threadList").click(function(n){return Forums.ScrollWindowToTop(),Forums.Common.SubmitMetricsToAIAndRedirect("Homepage.ClickedThreadListPagerLink",{linkid:$(this).attr("id")},$(this).attr("href"),n.ctrlKey),!1}),$("a.arrowdown",".threadsnippet").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.ThreadSnippetExpanded"),Forums.Homepage.expandThread($(this))}),$(".statefilter a").click(function(){var t=$(this).text(),n;Forums.Common.SubmitMetricsToAI("Homepage.ThreadMetadataStateFilterClicked",{state:t}),n={},n.Answered="Answered",n.Unanswered="Unanswered",n.Proposed="Proposed answers",n.Discussion="General discussion",$(".radioButtonText").filter(function(){return $(this).text()==n[t]}).click()});var n=$("a.arrowdown",".threadsnippet.selected");$(n).length>0&&$(n).click()},wireAllCategoriesBox:function(n){$("#allCategoryListContainer").find(".forumItem").mouseover(function(){var n=$(this).parents(".categoryArea:first").data("categoryname");Forums.Homepage.loadForumDetails(n,$(this).data("forumname"))}),$("#allCategoriesSearchContainer table.searchboxinnercontainer #searchbox").watermark(n)},wireCategoryListElements:function(n){function i(i){var u=$(i).parents(".categoryHeader",n).siblings(".forumFilter"),r=$(i).hasClass(t);$(u).toggle(!r),$(i).toggleClass(t)}var t="expanded";$(".categoryHeader",n).click(function(){Forums.Common.SubmitMetricsToAI("Homepage.CategoryExpanded");var n=$("a.arrowdown",$(this));return i($(n)),!1}),$(".categoryHeader").keydown(function(n){n.keyCode==13&&$(".categoryHeader").trigger("click")}),$(".forumFilter .checkboxText",n).click(function(){var n=$(this).siblings(".checkboxContainer").children("input[type='checkbox']");$(n).attr("checked",!$(n).attr("checked")).change()})},wireCategoryList:function(){$("#viewallCategoriesContainer").keydown(function(n){n.keyCode==13&&$("#viewallCategoriesContainer").trigger("click")}),$("#viewallCategoriesContainer").click(function(n){var t,i,r;Forums.Common.SubmitMetricsToAI("Homepage.ViewAllForumsLinkClicked"),t=$("#allCategoryPopupContainer"),$("#categoryOverlay").length<=0&&!($.browser.msie&&parseInt($.browser.version,10)<=7)&&(i=$('<div id="categoryOverlay" class="popupOverlay"/>'),i.css("height",$(document.body).height()),$("body").append(i)),$("#allCategoriesListChanged").val(!1),Forums.Homepage.loadAllCategories(),t.data("overlay","#categoryOverlay"),t.data("isModal",!0),Forums.Homepage.toggleDropDown($(t).parent(),n),$("#categoryPopupClose").focus(),r=$("input[name='searchTerm']:eq(1)").attr("watermark"),$("input[name='searchTerm']:eq(1)").attr("aria-label",r)}),$(".categoryArea").has(".chkForumSelector:checked").each(function(){$(this).find(".categoryHeader").addClass("selected")}),Forums.Homepage.addSelectedClassToSelectedCategoryHeaders()},addSelectedClassToSelectedCategoryHeaders:function(){$(".categoryHeader").removeClass("selected"),$(".categoryArea").has(".chkForumSelector:checked").each(function(){$(this).find(".categoryHeader").addClass("selected")})},setCategoryScopingState:function(n){function r(n){var t=$(".chkForumSelector:not(:checked)",n).length==0;$(".selectallcheckbox",$($(n))).attr("checked",t)}function i(){var t=Forums.Homepage.getCurrentForums();$(t).each(function(){var i=$("div[data-forumname='"+this+"'].forumItem:first",n),t;$(".chkForumSelector",i).attr("checked",!0),t=$(i).parents(".forumFilter"),$(t).is(":visible")?r(t):Forums.Homepage.showForumList(t)})}function t(){$(".forumFilter","#allCategoryListContainer").each(function(){Forums.Homepage.hideForumList($(this))})}$("input[type='checkbox']",n).attr("checked",!1),t(),i()},showForumList:function(n){Forums.Homepage.hideorShowForumList(n,!0)},hideForumList:function(n){Forums.Homepage.hideorShowForumList(n,!1)},hideorShowForumList:function(n,t){$(n).toggle(t);var i=$(n).siblings(".categoryHeader").find(".arrowdown");$(i).toggleClass("expanded",t)},updateSelectedForumsCount:function(){$("#totalselectedForums").html(" "+$("#categoriesListing input:checked").not(".selectallcheckbox").length+" ")},wireTagsList:function(){$(".forumremove").unbind("click").click(function(){var n=$(this).parents(".forumItem:first");return $($(".chkForumSelector[data-forumId='"+$(n).data("forumid")+"']")).each(function(){$(this).attr("checked",!1)}),Forums.Common.SubmitMetricsToAI("Homepage.ForumListRemoveLinkClicked",{forum:$(n).data("forumname")}),$(n).remove(),Forums.Homepage.redirectHomePageForTags(Forums.Homepage.Actions.Category),!1}),$("#clearSelectedTags").unbind("click").click(function(){return Forums.Common.SubmitMetricsToAI("Homepage.ClearSelectedTagsLinkClicked"),$(".forumItem","#selectedTags").remove(),$("#viewMoreTags").remove(),$(".chkForumSelector").attr("checked",!1),$("#selectedTags").hide(),Forums.Homepage.redirectHomePageForTags(Forums.Homepage.Actions.Category),!1});$(".forumtag").unbind("click").on("click",function(){var n=$(this).parent(".tagcontainer");return $(n).hasClass("singledout")?($(".tagcontainer").removeClass("dim").removeClass("singledout"),Forums.Homepage.redirectHomePageForTags(Forums.Homepage.Actions.Category)):($(".tagcontainer").addClass("dim").removeClass("singledout"),$(n).removeClass("dim").addClass("singledout"),Forums.ClientRefresh.Controller.get($(this).attr("href"),Forums.Homepage.Actions.Category)),!1});$("#inputTagSearch").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.SearchForumsClicked")}),$("#viewMoreTags a").click(function(){return Forums.Common.SubmitMetricsToAI("Homepage.ViewMoreTagsClicked",{text:$(this).html()}),$(this).remove(),$(".forumItem.hiddenItem").removeClass("hiddenItem"),!1})},selectTag:function(n,t,i,r,u,f){$("#selectedTags").show(),$("#forumItem_"+t).length==0&&$(".tags","#selectedTags").append("<div id='forumItem_"+t+"' class='forumItem' data-categoryname='"+n+"' data-forumname='"+i+"' data-forumid='"+t+"' data-forumdetailsurl='"+u+"'><div class='tagcontainer defaultColor'><a href='"+f+"' class='forumtag'>"+r+"</a><div class='forumremove'><a href='#' class='removeTag' title='"+ForumsRes.SideBar_RemoveText+"'>x</a></div></div><div class='forumDetailsTip'></div></div>"),$("#inputTagSearch").val(""),$($(".chkForumSelector[data-forumId='"+t+"']")).each(function(){$(this).attr("checked",!0)}),Forums.Common.SubmitMetricsToAI("Homepage.ForumSelectedFromForumsDropDown",{forum:r,forumId:t}),Forums.Homepage.redirectHomePageForTags(Forums.Homepage.Actions.Category)},wireFilterBar:function(){var t,n;$(".filterdropdown","#filterBar").click(function(n){Forums.Homepage.toggleFilterDropDown($(this),n)}),$(".threadFilterItem").find(".chkFilterSelector").change(function(){$(this).parents(".threadFilterItem:first").data("filter")=="alllanguages"?(Forums.Common.SubmitMetricsToAI("Homepage.AllLanguagesSelected"),Forums.Homepage.redirectHomePageForTags(Forums.Homepage.Actions.FilterWithAllLanguages)):(Forums.Common.SubmitMetricsToAI("Homepage.NewFilterSelected",{filter:$(this).attr("id")}),Forums.Homepage.redirectHomePageForTags(Forums.Homepage.Actions.Filter))}),$(".threadFilterItem").keypress(function(n){if(n.which==13){var t=$(this).find("input");t.attr("checked")!=null?t.removeAttr("checked"):t.attr("checked","checked"),$(".threadFilterItem").find(".chkFilterSelector").change(),$(this).parent().click()}}),$("#threadFilter").find(".checkboxText").click(function(){var n=$(this).siblings("input[type='checkbox']");$(n).attr("checked",!$(n).attr("checked")).change()}),$("#threadFilter").keypress(function(n){n.which==13&&$("#threadFilter").click()}),$(".radioButtonText").click(function(){var n=$(this).siblings('input[type="radio"]');$(n).attr("checked",!$(n).attr("checked")).change()}),$("li.sortSelector").click(function(){$("#sortFilter").find(".selectedSort").each(function(){$(this).removeClass("selectedSort").addClass("unselectedSort")}),$(this).removeClass("unselectedSort").addClass("selectedSort"),Forums.Common.SubmitMetricsToAI("Homepage.SortSelected",{sort:$(this).attr("id")}),Forums.Homepage.redirectHomePageForTags(Forums.Homepage.Actions.Sort)}),$("#sortFilter").keypress(function(n){n.which==13&&$("#sortFilter").click()}),$("li.sortSelector").keypress(function(n){n.which==13&&($(this).find("input").attr("checked","checked"),$("li.sortSelector").click(),$("#sortFilter").click())}),t=Forums.Homepage.getChildIdList("#ThreadFilterPopup",".threadFilterItem"),$("#threadFilter").attr("aria-owns",t),n=Forums.Homepage.getChildIdList("#SortFilterPopup",".unselectedSort.sortSelector"),$("#sortFilter").attr("aria-owns",n)},getChildIdList:function(n,t){var i="";return $(n).find(t).each(function(){i+=$(this).attr("id")+" "}),i.trim()},wireActivitySidebarSection:function(){var t=$("#homepageLeaderboard"),n=$("#myActivityWidget");n.length===1?Forums.Homepage.loadMyActivityWidget(n):t.length===1&&Forums.Homepage.loadLeaderBoard(t,1)},wireAnnouncements:function(){$("#seeAnnouncementsLinkBox").click(function(n){Forums.Homepage.toggleDropDown($(this).parent(),n)}),$("li.announcement .announcementContainer").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.AnnouncementsClicked"),$(this).find("a.arrowdown").toggleClass("expanded"),$(this).siblings(".announcementDetails").toggle()}),$("li.announcement .linkAnnouncement").click(function(n){n.preventDefault();var t=$(this).parents("li.announcement"),i=$("div.linkContent",$(t));i.length>0?i.remove():(i="<div class='linkContent'> <div style='margin-right: 4px;'><label>"+ForumsRes.Announcement_LinkToAnnouncement+"</label><a class='close' href='javascript:void(0)' style='float:right;'>"+ForumsRes.Announcement_CloseText+"</a></div>  <div><input type='text' class='announcementUrl' readonly='readonly' value='"+$(this).attr("href")+"' /></div>  </div>",$(i).insertBefore($("div.announcementDetails",$(t))),$("a.close",t).click(function(n){n.stopPropagation(),$("div.linkContent",t).remove()}),$("input[type='text']",t).click(function(n){n.stopPropagation()}).focus())}),$("li.announcement .deleteAnnouncement").click(function(n){n.preventDefault();var t=$(this).parents(".announcement:first");$.ajax({type:"POST",url:$(this).attr("href"),data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),isDeleted:!0},success:function(){$(t).remove()}})});var n=$("#topBarImportantInfoContainer .announcementContainer.selected");$(n).length>0&&($("#seeAnnouncementsLinkBox").click(),$(n).click())},getCurrentForums:function(){var n=[];return $(".forumItem","#selectedTags").each(function(){n.push($(this).data("forumname"))}),Forums.GetJSONArray(JSON.stringify(n))},getCurrentCategories:function(){return Forums.GetJSONArray($("#hdnCategories").val())},selectAllForums:function(n){var i=$(n).parents("li.categoryArea:first").data("categoryid"),t=$(n).is(":checked");$(".allForumItems_"+i).find(".chkForumSelector").attr("checked",t),Forums.Common.SubmitMetricsToAI("Homepage.SelectAllChanged",{categoryId:i,selectedValue:t})},getSelectedForums:function(n){var t=[];return $(n).find(".chkForumSelector:checked").each(function(){t.push($(this).parents(".forumItem:first").data("forumname"))}),t},ForumCounts:null,setForumCounts:function(n){Forums.Homepage.ForumCounts=n},ForumsAll:null,setForumsAll:function(n){Forums.Homepage.ForumsAll=n},getSelectedForumsAndCategoriesFromTags:function(){var t=[],u=[],r=[],f=!1,n={},i;if($(".forumItem","#selectedTags").each(function(){var i=$(this).attr("data-categoryName");n[i]=$(n[i]).length==0?1:n[i]+1,t.push($(this).data("forumname"))}),this.ForumsAll&&$(this.ForumsAll).each(function(n){n.isIrootForum&&r.push(n.forumName)}),$(r).not(t).length==0&&$(t).not(r).length==0)t=[],u=[],f=!0;else for(i in n)n[i]==Forums.Homepage.ForumCounts[i]&&(u.push(i),$(".forumItem[data-categoryname='"+i+"']","#selectedTags").each(function(){Forums.Common.RemoveFromArray(t,$(this).data("forumname"))}));return{selectedForums:t,selectedCategories:u,useDefaultIrootForums:f}},getSelectedForumsWithCategories:function(n){var t={};return $(n).find("li.categoryArea").each(function(){var r=$(this).find(".chkForumSelector:checked"),u,n,i;r.length>0&&(u=$(this).find(".chkForumSelector").length,n=[],r.each(function(){n.push($(this).parents(".forumItem:first").data("forumname"))}),i=$(this).data("categoryname"),t[i]={totalForums:u,forums:n})}),t},redirectHomePageForTags:function(n){var i=Forums.Homepage.getSelectedForumsAndCategoriesFromTags(),f,e,r;Forums.Homepage.wireAskAQuestion(i.selectedForums),f=[],e=$("#homePageFilterBarContainer"),$(e).find(".chkFilterSelector:checked").each(function(){var n=$(this).parents(".threadFilterItem:first").data("filter");f.push(n)}),r=[],$(e).find("li.selectedSort").each(function(){r.push($(this).data("sort"))});var u=encodeURIComponent($("#threadsearchbarContainer input#searchbox").val()),o=$("#hdnUserName").val(),s=Forums.BaseUrl(),t=s;o&&(t=Forums.AppendQuestionOrAmpersandToUrl(t),t+="user="+o),i.selectedCategories.length>0&&(t=Forums.CommaSeparateAndAddListToUrl(t,"category",i.selectedCategories)),i.selectedForums.length>0&&(t=Forums.CommaSeparateAndAddListToUrl(t,"forum",i.selectedForums)),t=Forums.CommaSeparateAndAddListToUrl(t,"filter",f),t=Forums.CommaSeparateAndAddListToUrl(t,"sort",r),u&&u!=encodeURIComponent(Forums.Homepage.searchWatermark)&&(t=Forums.AppendQuestionOrAmpersandToUrl(t),t+="searchTerm="+u),i.useDefaultIrootForums||i.selectedForums.length!=0||i.selectedCategories.length!=0||(t=Forums.AppendQuestionOrAmpersandToUrl(t),t+="brandIgnore=true",$("#selectedTags").hide()),Forums.Homepage.updateSignInOutLink(s,t),Forums.ClientRefresh.Controller.get(t,n)},redirectHomePage:function(n,t,i,r){var h,o,l,c;Forums.Homepage.addSelectedClassToSelectedCategoryHeaders(),f=Forums.Homepage.getSelectedForums($("#categoriesListing")),Forums.Homepage.wireAskAQuestion(f);var a=Forums.Homepage.getSelectedForumsWithCategories(n),f=[],e=[];for(h in a)o=a[h],o.totalForums==o.forums.length?e.push(h):f.push.apply(f,o.forums);l=[],$(t).find(".chkFilterSelector:checked").each(function(){var n=$(this).parents(".threadFilterItem:first").data("filter");l.push(n)}),r==Forums.Homepage.Actions.FilterWithAllLanguages&&(f=Forums.Homepage.getCurrentForums(),e=Forums.Homepage.getCurrentCategories()),c=[],$(t).find("li.selectedSort").each(function(){c.push($(this).data("sort"))});var s=encodeURIComponent($("#threadsearchbarContainer input#searchbox").val()),y=$("#hdnUserName").val(),v=Forums.BaseUrl(),u=v;y&&(u+=(u.indexOf("?")>-1?"&":"?")+"user="+y),e.length>0&&(u=Forums.CommaSeparateAndAddListToUrl(u,"category",e)),f.length>0&&(u=Forums.CommaSeparateAndAddListToUrl(u,"forum",f)),u=Forums.CommaSeparateAndAddListToUrl(u,"filter",l),u=Forums.CommaSeparateAndAddListToUrl(u,"sort",c),s&&s!=encodeURIComponent(i)&&(u+=(u.indexOf("?")>-1?"&":"?")+"searchTerm="+s),f.length==0&&e.length==0&&(u+=(u.indexOf("?")>-1?"&":"?")+"brandIgnore=true"),Forums.Homepage.updateSignInOutLink(v,u),Forums.ClientRefresh.Controller.get(u,r)},updateSignInOutLink:function(n,t){var u=$(".scarabLink"),f=u.attr("href"),e=/ReturnUrl=(.+)/gim,i=e.exec(f),r;i!=null&&(r=encodeURIComponent(t),u.attr("href",f.replace(i[1],r)))},expandThread:function(n){var t=$(n).parents("div.threadsnippet:first").find("div.expandedThreadContainer"),i=$(n).parent().data("threadmessagesurl");$(n).toggleClass("expanded"),$(t).toggle($(n).hasClass("expanded")),$(n).hasClass("expanded")&&Forums.Homepage.loadThreadPreview(t,i)},hideDropDown:function(n){$(".popup").each(function(){if((!$(this).find(n.target).length||$(n.target).hasClass("closePopup"))&&($(this).hide(),$(this).data("overlay")&&$($(this).data("overlay")).hide(),$(this).data("isModal"))){var t=$("body");t.removeClass("no-vertical-scrolling"),typeof $(this).data("originalBodyWidthStyle")!="undefined"&&(document.body.style.width=$(this).data("originalBodyWidthStyle"))}})},toggleDropDown:function(n,t){var i=n.children(".popup"),u=!$(i).is(":visible"),r;Forums.Homepage.hideDropDown(t),u&&(i.data("overlay")&&$(i.data("overlay")).toggle(),i.toggle(),i.data("isModal")&&(r=$("body"),i.data("originalBodyWidthStyle",document.body.style.width),r.css("width",r.width()+"px"),r.addClass("no-vertical-scrolling")),t.stopPropagation(),$("body").click(function(n){Forums.Homepage.hideDropDown(n)}))},toggleFilterDropDown:function(n,t){$(".filterdropdown","#filterBar").each(function(){$(n).attr("id")!=$(this).attr("id")&&$(this).children(".popup").hide()}),Forums.Homepage.toggleDropDown(n,t)},loadThreadPreview:function(n,t){t=Forums.AppendQuestionOrAmpersandToUrl(t)+"time="+ +new Date,$.ajax({type:"GET",beforeSend:function(){$(n).show()},url:t,success:function(t){$(n).html(t),$("#threadList").addClass("nowhitespace"),prettyPrint(),$("li.message",n).each(Forums.Message.decorateMessage),$(n).find("a[name='reply']").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.ExpandedThreadReplyClicked")}),$(n).find("a.voteuphreflink").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.ExpandedThreadVoteLinkClicked")})},error:function(){var t,i;$(n).html('<div class="links"></div>'),t=$("div.links",n),$(t).append("<a class='view'></a>"),i=$(n).parent().find("h3 a.threadUrl").attr("href"),$("a.view",t).text(ForumsRes.thread_viewThreadText).attr("href",i).attr("title",ForumsRes.thread_viewThreadText),$(t).append("<a class='close'></a>"),$("a.close",t).text(ForumsRes.thread_closePreviewText).attr("href","javascript:void(0)").attr("title",ForumsRes.thread_closePreviewText).click(function(){$(n).hide()})}})},loadLeaderBoard:function(n,t){var i=$(n).data("leaderboardurl");t++,(t>4||t<2)&&(t=2),$(n).addClass("submitting").load(i,"leaderBoard="+t+"&rnd="+Math.random(),function(){$(n).removeClass("submitting"),$("a[name='seeMore']").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.LeaderboardNextLinkClicked"),Forums.Homepage.loadLeaderBoard($(this).data("nextindex"))})})},loadMyActivityWidget:function(n){var t=$(n).data("contenturl");$(n).addClass("submitting").load(t,"rnd="+Math.random(),function(){$(n).removeClass("submitting")})},loadForumDetails:function(n,t){var u="categoryDetails_"+n,i,r;$("#"+u).length?($(".singleforumdetails").hide(),$("#forumDetailsContainerBanner").hide(),$("#forumdetails_"+t).show()):(i=document.createElement("div"),$(i).attr("id",u),$("#forumDetailsContainer").append(i),r=$("#category_"+n).children(".categoryHeader").data("forumdetailsurl"),$.getJSON(r,function(n){Forums.Homepage.loadForumDetailsForCategory(n,i,t)}).fail(function(n,t,i){$("#forumDetailsContainer").html("Error: "+i)}))},loadForumDetailsForCategory:function(n,t,i){$.each(n,function(n,i){var r=$("#forumDetailsTemplate").clone().hide(),f,u,e;$(r).attr("id","forumdetails_"+i.Name).attr("class","singleforumdetails"),$(r).children("h3.header").prepend(i.DisplayName),$(r).children("div.content").html(i.Description),$(r).find("img.rss").parent().attr("href",i.RSSUrl),i.ShowManageForums&&(f=$(r).find(".manageForumSection"),$(f).find(".manageForumLink").attr("href",i.ManageForumUrl).text(i.ManageForumsText),$(f).find(".manageRolesLink").attr("href",i.ManageRolesUrl).text(i.ManageRolesText),$(f).show()),u=$(r).find("a.addRemoveForum"),$(u).attr("href",i.FavoriteUrl),i.HasFavoritePermission?$(u).attr("title",i.AddToMyForumsText).attr("name","favorite").attr("data-reverseText",i.RemoveFromMyForumsText).attr("data-reversename","unfavorite").text(i.AddToMyForumsText):i.HasUnFavoritePermission===!0&&$(u).attr("title",i.RemoveFromMyForumsText).attr("name","unfavorite").attr("data-reverseText",i.AddToMyForumsText).attr("data-reversename","favorite").text(i.RemoveFromMyForumsText),$(t).append(r),e=$(u).attr("name"),typeof e!="undefined"&&e!==!1&&$(u).show()}),$(".singleforumdetails").hide(),$("#forumdetails_"+i).show(),$("#forumDetailsContainerBanner").hide(),$(t).find("a.addRemoveForum").click(function(){var t=$(this).attr("name")==="favorite",n=$(this);return $.post($(n).attr("href"),{isFavorited:t},function(t){if(t.success){var u=$(n).text(),f=$(n).attr("name"),i=$(n).attr("data-reverseText"),r=$(n).attr("data-reversename");$(n).attr("title",i).attr("name",r).attr("data-reverseText",u).attr("data-reversename",f),$(n).text(i)}},"json"),!1})},logClick:function(){var i=$(document).find("#hdnQueryId").val(),t=$(document).find("#hdnPage").val(),r=$(this).data("threadid"),f=$(this).data("block"),u=$(this).data("position"),n;i&&t&&(n={queryId:i,page:t,threadId:r,block:f,position:u},Forums.Common.SubmitMetricsToAIAndRedirect("Homepage.SearchResultClick",n,$(this).attr("href"),event.ctrlKey))},wireSearchResultEvents:function(){$(".threadUrl").click(Forums.Homepage.logClick),$(".threadstatus").click(function(){Forums.Common.SubmitMetricsToAI("Homepage.ThreadIconClick",{threadId:$(this).parents(".threadblock").data("threadid")})});var n={};$(".threadstatus").hover(function(){var t=$(this);n=setTimeout(function(){Forums.Common.SubmitMetricsToAI("Homepage.ThreadIconHover",{threadId:t.parents(".threadblock").data("threadid"),state:t.attr("title")})},500)},function(){clearTimeout(n)})},logSerp:function(){var i=$(document).find("#hdnPage").val(),r=$(document).find("#hdnQueryId").val(),n=$(document).find("#hdnQuery").val(),t;i&&r&&n&&(t={queryId:r,query:n,page:i},Forums.Common.SubmitMetricsToAI("Homepage.SearchResultPageView",t))}},Forums.ThreadPage={wirePageElements:function(){this.attachTooltipHandler(),this.getRelatedThreads(),Forums.ForumDetails.wireForumDetailLinks()},wireSearchBar:function(n){$("#threadsearchbarContainer table.searchboxinnercontainer #searchimage").click(function(){var n=$(this).parents(".searchboxinnercontainer:first").find("#searchbox").not(".watermark"),t=$(n).length==1?$(n).val():"";Forums.Common.SubmitMetricsToAI("Homepage.MainSearchBoxSearchIconClicked",{searchTerm:t})}),$("#threadsearchbarContainer table.searchboxinnercontainer #searchbox").watermark(n),$("#threadsearchbarContainer table.searchboxinnercontainer #searchimage").attr("aria-label",n),$("#threadsearchbarContainer table.searchboxinnercontainer #searchbox").keypress(function(n){var t=window.mscc;t&&!t.hasConsent()&&t.setConsent(),n.which==13&&(Forums.Common.SubmitMetricsToAI("Homepage.EnterPressedOnSearchBox"),$(this).submit())}).click(function(){Forums.Common.SubmitMetricsToAI("Homepage.MainSearchBoxSelected")})},getRelatedThreads:function(){var n=$("#relatedThreads").data("url");n&&$.ajax({url:n}).done(function(n){$("#relatedThreads").html(n),Forums.ThreadPage.wireRelatedThreadLinks()})},attachTooltipHandler:function(){$(".forumBreadcrumb").each(function(){$(this).hover(function(){var n=$(this).children(".breadcrumbTip");n&&(n.css("top","20px"),n.css("left","0px"),n.show())},function(){var n=$(this).children(".breadcrumbTip");n&&n.hide()})})},wireRelatedThreadLinks:function(){$("#relatedThreads a").click(function(n){var t={linkTitle:$(this).html(),linkHref:$(this).attr("href"),question:$('#threadPageContainer > h1 > span[name="subject"]').html(),questionId:$("#rootMessage > li.message.root").attr("id"),isQuestionAnswered:$("img.icon.question.answered").length>0};return Forums.Common.SubmitMetricsToAIAndRedirect("relatedThreadsLink",t,$(this).attr("href"),n.ctrlKey),!1})},logThreadPageEnter:function(){var t=$("#rootMessage>li.message:first").attr("id"),n={threadId:t};Forums.Common.SubmitMetricsToAI("Thread.PageEnter",n)},logThreadPageDwell:function(){setTimeout(function(){var t=$("#rootMessage>li.message:first").attr("id"),n={threadId:t,dwellTimeInSecs:Forums.Constants.ThreadPageDwellTimeInSecs};Forums.Common.SubmitMetricsToAI("Thread.PageDwell",n)},Forums.Constants.ThreadPageDwellTimeInSecs*1e3)}},Forums.NewThreadPage={wire:function(){$("#forumNameLine").is(":visible")&&$("#Subject").focus()}},Forums.Toggler=function(){function a(){Modernizr.localstorage||(localStorage={}),($(r).length>0||$(i).length>0)&&l()}function v(t,i,r,u,o){localStorage[n]==="1"||typeof localStorage[n]=="undefined"?(e(t,i,r,u,o),localStorage[n]=0):(f(t,i,r,u,o),localStorage[n]=1)}function e(n,i,r,u,f){n.removeClass("toggleOpen").addClass("toggleClose"),f==="home"&&$("#homePageFilterBarContainer").addClass("expandedFilterBar"),i.css("display","none"),$(r).length==1&&t==-1&&(t=$(r).width()),r.addClass("expandedContent"),r.css("width","100%"),u&&u.addClass("expandedContent")}function f(n,i,r,u,f){n.removeClass("toggleClose").addClass("toggleOpen"),f==="home"&&$("#homePageFilterBarContainer").removeClass("expandedFilterBar"),i.css("display","block"),$(r).length==1&&t==-1&&(t=$(r).width()),r.removeClass("expandedContent"),r.css("width",t+"px"),u&&u.removeClass("expandedContent");var o=$(".profile-userimage-large"),e=$(o).children("img:first");$(e).length===1&&$(e).width()===0&&$(e).width($(o).width())}function l(){p(),y()}function p(){$(i).click(function(){v($(this),$(c),$(u),null,"home")}),typeof localStorage[n]!="undefined"&&(localStorage[n]==="0"?e($(i),$(c),$(u),null,"home"):f($(i),$(c),$(u),null,"home"))}function y(){$(r).click(function(){v($(this),$(s),$(o),$(h),"thread")}),typeof localStorage[n]!="undefined"&&(localStorage[n]==="0"?e($(r),$(s),$(o),$(h)):f($(r),$(s),$(o),$(h)))}var n="ShowSidebar",r="#threadPageContentContainer #toggleSidebar",i="#allThreadsContainer #toggleSidebar",s="#threadPageSidebarContainer",o="#threadPageContentContainer",h="#threadPageContainer .messageContent",c="#homePageSidebarContainer",u="#homePageContentContainer",t=-1;return $(function(){a()}),{setup:a,wireToggleButton:l}}(),Forums.Leaderboards={seeMore:function(n){var t=$("#rail div.leaderboards"),i;n++,n>4&&(n=0),i=window.leaderBoardUrl+"&leaderBoard="+n,t.fadeTo("slow",.5),t.addClass("submitting"),t.parent("div").load(i)}},Forums.Users={usersAction:function(n,t){return function(){return $("img.icon",n).addClass("submitting"),$.post($(n).attr("href"),t,function(){$(n).remove()},"json"),!1}},blockAvatar:function(){var n=$(this);$(this).click(Forums.Users.usersAction(n,{blockAvatar:!0}))},unblockAvatar:function(){var n=$(this);$(this).click(Forums.Users.usersAction(n,{blockAvatar:!1}))},decorateUsers:function(){$("a[name='blockUnblockAvatar']",this).each(Forums.Users.blockAvatar)}},Forums.Common={TrackCustomClick:function(n,t,i,r){typeof t_omni_utils!="undefined"&&t_omni_utils&&t_omni_utils.omniModTracking&&t_omni_utils.omniModTracking(!0,n,"",t,i,r)},FixPartnerForumContextUrls:function(n){var u=$("#p_ApplicationUrl"),r,t,i;typeof u!="undefined"&&u&&(r=$("#connect-context .home-link-container a",n),typeof r!="undefined"&&r&&r.attr("href",u.attr("value"))),t=$("#p_ApplicationForumContextUrl"),typeof t!="undefined"&&t&&(i=$("#connect-context .connection-link-container a",n),typeof i!="undefined"&&i&&(t.attr("value")?i.attr("href",t.attr("value")):i.remove()))},ShowPrompt:function(n,t,i){this.clicked=!0,$.prompt(n,{prefix:"spWarning",top:"40%",buttons:{closeButton:{title:t,value:!0}},submit:function(){window.location.replace(i)}})},SubmitMetricsToAIAndRedirect:function(n,t,i,r){return r?!0:(Forums.Common.SubmitMetricsToAI(n,t),setTimeout(function(){Forums.Redirect(i)},500),!1)},SubmitMetricsToAI:function(){},MetricsSubmittedCallback:function(){},RemoveFromArray:function(n,t){for(var i=0;i<n.length;i++)if(n[i]==t){n.splice(i,1);break}},GetBaseMetricObject:function(){var t=$("a.createProfileLink:first","div.profileName"),n="anonymous";return t.is(":visible")&&(n=$(t).html()),{username:n,referrer:document.referrer,currentUrl:document.URL}}},$.addToRail=function(n,t){for(var f,u,r=$("#rail"),i=0;i<n.length;i++)f=document.createElement("div"),r.append(f),u=n[i].indexOf("?")!=-1?"&":"?",n[i].indexOf("rightrailannouncement")!=-1?$(f).load(n[i]+u+"rnd="+Math.random(),null,function(){Forums.Common.FixPartnerForumContextUrls(r)}):$(f).load(n[i]+u+"rnd="+Math.random(),null,t),n[i].indexOf("leaderboards")!=-1&&(window.leaderBoardUrl=n[i]+u+"rnd="+Math.random());r.append($(".help",r))},$.fn.popup=function(){$(this).each(function(){var i="a[name='"+$(this).attr("name")+"']",n="ul[name='"+$(this).attr("name")+"Popup']",t;$(this).find(Forums.Constants.ExpandCollapseImageRef).detach(),$(this).append(Forums.Constants.ExpandCollapseImage),t=function(){$("ul.popup").hide(),$("body").unbind("click.popup")},$(this).click(function(r){var e,u,f;$("ul.popup").hide(),e=$(n).width(),u=$(i).position(),$(n).attr("popupAlign")==="right"?$(n).css("left",u.left+$(r.target).width()/2-e):$(n).attr("popupAlign")==="rightRail"?$(n).css("right",$(i).offsetParent().width()-u.left):$(n).css("left",u.left),f=r.target.className=="expcol"?r.target.parentElement:r.target,$(n).css("top",u.top+$(f).height()*1.5),$(n).show(),r.stopPropagation(),$("body").bind("click.popup",t)})})},Forums.ManageRoles={selectAll:function(){$("#selectAll").attr("checked")?$("input[name='userId']").attr("checked","checked"):$("input[name='userId']").attr("checked",!1)}},$.fn.removeWatermark=function(){$(this).each(function(){$(this).hasClass("watermark")&&($(this).val(""),$(this).removeClass("watermark"))})},$.removeAllWatermarks=function(){$(".watermark").each(function(){$(this).removeWatermark()})},$.fn.watermark=function(n){$(this).each(function(){$(this).removeWatermark(),$(this).bind("click",function(){$(this).hasClass("watermark")&&($(this).val(""),$(this).removeClass("watermark"))}),$(this).bind("blur",function(){($(this).val()==""||$(this).val()==n)&&($(this).addClass("watermark"),$(this).val(n))}),$(this).blur()})},$.fn.watermarkVal=function(){return $(this).hasClass("watermark")?"":$(this).val()},$.fn.toggleVisibility=function(){var n="visible",t="invisible";$(this).hasClass(n)?$(this).removeClass(n).addClass(t):$(this).removeClass(t).addClass(n)};$("input#ErrorSearchButton").on("click",function(){var t=$("input#ErrorSearchBox").val(),n;t&&(n=$("input#SearchUri").val(),n)&&(window.location.href=n.replace("{0}",escape(t)))});Forums.Redirect=function(n){window.location.href=n},Forums.CommaSeparateAndAddListToUrl=function(n,t,i){return $(i).length>0&&(n+=(n.indexOf("?")>-1?"&":"?")+t+"="+encodeURIComponent(i.join(","))),n},Forums.BaseUrl=function(){return window.location.href.split("#")[0].split("?")[0]},Forums.GetJSONArray=function(n){if(n!="")try{return window.JSON?JSON.parse(n):$.parseJSON(n)}catch(t){}return[]},Forums.AppendQuestionOrAmpersandToUrl=function(n){return n&&(n+=n.indexOf("?")!=-1?"&":"?"),n},Forums.ScrollWindowToTop=function(){window.scrollTo(0,0)},Forums.loadScript=function(n){$(document).ready(function(){$.ajax({async:!0,type:"GET",url:n,data:null,dataType:"script",cache:!0})})},jQuery.expr[":"].Contains=function(n,t,i){return jQuery(n).text().toUpperCase().indexOf(i[3].toUpperCase())>=0},function(n){n.prompt=function(t,i){var s,h;i=n.extend({},n.prompt.defaults,i),n.prompt.currentPrefix=i.prefix;var e=n.browser.msie&&n.browser.version<7,v=n(document.body),o=n(window);i.classes=n.trim(i.classes),i.classes!=""&&(i.classes=" "+i.classes),s='<div class="'+i.prefix+"box"+i.classes+'" id="'+i.prefix+'box">',i.useiframe&&(n("object, applet").length>0||e)?s+='<iframe src="javascript:false;" style="display:block;position:absolute;z-index:-1;" class="'+i.prefix+'fade" id="'+i.prefix+'fade"></iframe>':(e&&n("select").css("visibility","hidden"),s+='<div class="'+i.prefix+'fade" id="'+i.prefix+'fade"></div>'),s+='<div class="'+i.prefix+'" id="'+i.prefix+'"><div class="'+i.prefix+'container"><div class="',s+=i.prefix+'close">X</div><div id="'+i.prefix+'states"></div>',s+="</div></div></div>";var r=n(s).appendTo(v),u=r.children("#"+i.prefix),f=r.children("#"+i.prefix+"fade");t.constructor==String&&(t={state0:{html:t,buttons:i.buttons,focus:i.focus,submit:i.submit}}),h="",n.each(t,function(r,u){u=n.extend({},n.prompt.defaults.state,u),t[r]=u,h+='<div id="'+i.prefix+"_state_"+r+'" class="'+i.prefix+'_state" style="display:none;"><div class="'+i.prefix+'message">'+u.html+'</div><div class="'+i.prefix+'buttons">',n.each(u.buttons,function(n,t){h+=typeof t=="object"?'<button name="'+i.prefix+"_"+r+"_button"+t.title.replace(/[^a-z0-9]+/gi,"")+'" id="'+i.prefix+"_"+r+"_button"+t.title.replace(/[^a-z0-9]+/gi,"")+'" value="'+t.value+'">'+t.title+"</button>":'<button name="'+i.prefix+"_"+r+"_button"+n+'" id="'+i.prefix+"_"+r+"_button"+n+'" value="'+t+'">'+n+"</button>"}),h+="</div></div>"}),u.find("#"+i.prefix+"states").html(h).children("."+i.prefix+"_state:first").css("display","block"),u.find("."+i.prefix+"buttons:empty").css("display","none"),n.each(t,function(t,r){var f=u.find("#"+i.prefix+"_state_"+t);f.children("."+i.prefix+"buttons").children("button").click(function(){var h=f.children("."+i.prefix+"message"),e=r.buttons[n(this).text()],s,t,o;if(e==undefined)for(s in r.buttons)r.buttons[s].title==n(this).text()&&(e=r.buttons[s].value);typeof e=="object"&&(e=e.value),t={},n.each(u.find("#"+i.prefix+"states :input").serializeArray(),function(n,i){t[i.name]===undefined?t[i.name]=i.value:typeof t[i.name]==Array||typeof t[i.name]=="object"?t[i.name].push(i.value):t[i.name]=[t[i.name],i.value]}),o=r.submit(e,h,t),(o===undefined||o)&&a(!0,e,h,t)}),f.find("."+i.prefix+"buttons button:eq("+r.focus+")").addClass(i.prefix+"defaultbutton")});var y=function(){r.css({top:o.scrollTop()})},c=function(){var t,n;i.persistent?(t=0,r.addClass(i.prefix+"warning"),n=setInterval(function(){r.toggleClass(i.prefix+"warning"),t++>1&&(clearInterval(n),r.removeClass(i.prefix+"warning"))},100)):a()},p=function(t){var f=window.event?event.keyCode:t.keyCode;if(f==27&&c(),f==9){var i=n(":input:enabled:visible",r),e=!t.shiftKey&&t.target==i[i.length-1],u=t.shiftKey&&t.target==i[0];if(e||u)return setTimeout(function(){if(i){var n=i[u===!0?i.length-1:0];n&&n.focus()}},10),!1}},l=function(){r.css({position:e?"absolute":"fixed",height:o.height(),width:"100%",top:e?o.scrollTop():0,left:0,right:0,bottom:0}),f.css({position:"absolute",height:o.height(),width:"100%",top:0,left:0,right:0,bottom:0}),u.css({position:"absolute",top:i.top,left:"50%",marginLeft:u.outerWidth()/-2})},w=function(){f.css({zIndex:i.zIndex,display:"none",opacity:i.opacity}),u.css({zIndex:i.zIndex+1,display:"none"}),r.css({zIndex:i.zIndex})},a=function(t,s,h,a){u.remove(),e&&v.unbind("scroll",y),o.unbind("resize",l),f.fadeOut(i.overlayspeed,function(){f.unbind("click",c),f.remove(),t&&i.callback(s,h,a),r.unbind("keypress",p),r.remove(),e&&!i.useiframe&&n("select").css("visibility","visible")})};return l(),w(),e&&o.scroll(y),f.click(c),o.resize(l),r.bind("keydown keypress",p),u.find("."+i.prefix+"close").click(a),f.fadeIn(i.overlayspeed),u[i.show](i.promptspeed,i.loaded),u.find("#"+i.prefix+"states ."+i.prefix+"_state:first ."+i.prefix+"defaultbutton").focus(),i.timeout>0&&setTimeout(n.prompt.close,i.timeout),r},n.prompt.defaults={prefix:"jqi",classes:"",buttons:{Ok:!0},loaded:function(){},submit:function(){return!0},callback:function(){},opacity:.6,zIndex:999,overlayspeed:"slow",promptspeed:"fast",show:"fadeIn",focus:0,useiframe:!1,top:"15%",persistent:!0,timeout:0,state:{html:"",buttons:{Ok:!0},focus:0,submit:function(){return!0}}},n.prompt.currentPrefix=n.prompt.defaults.prefix,n.prompt.setDefaults=function(t){n.prompt.defaults=n.extend({},n.prompt.defaults,t)},n.prompt.setStateDefaults=function(t){n.prompt.defaults.state=n.extend({},n.prompt.defaults.state,t)},n.prompt.getStateContent=function(t){return n("#"+n.prompt.currentPrefix+"_state_"+t)},n.prompt.getCurrentState=function(){return n("."+n.prompt.currentPrefix+"_state:visible")},n.prompt.getCurrentStateName=function(){var t=n.prompt.getCurrentState().attr("id");return t.replace(n.prompt.currentPrefix+"_state_","")},n.prompt.goToState=function(t,i){n("."+n.prompt.currentPrefix+"_state").slideUp("slow"),n("#"+n.prompt.currentPrefix+"_state_"+t).slideDown("slow",function(){n(this).find("."+n.prompt.currentPrefix+"defaultbutton").focus(),typeof i=="function"&&i()})},n.prompt.nextState=function(t){var i=n("."+n.prompt.currentPrefix+"_state:visible").next();n("."+n.prompt.currentPrefix+"_state").slideUp("slow"),i.slideDown("slow",function(){i.find("."+n.prompt.currentPrefix+"defaultbutton").focus(),typeof t=="function"&&t()})},n.prompt.prevState=function(t){var i=n("."+n.prompt.currentPrefix+"_state:visible").prev();n("."+n.prompt.currentPrefix+"_state").slideUp("slow"),i.slideDown("slow",function(){i.find("."+n.prompt.currentPrefix+"defaultbutton").focus(),typeof t=="function"&&t()})},n.prompt.close=function(){n("#"+n.prompt.currentPrefix+"box").fadeOut("fast",function(){n(this).remove()})},n.fn.prompt=function(t){t==undefined&&(t={}),t.withDataAndEvents==undefined&&(t.withDataAndEvents=!1),n.prompt(n(this).clone(t.withDataAndEvents).html(),t)}}(jQuery)